@page "/create-resource"
@attribute [Authorize]

@using OroIdentity.Web.Client.Interfaces
@using OroIdentity.Web.Client.Models

@inject NavigationManager NavigationManager
@inject IScopesService Service

<PageTitle>Resources</PageTitle>

<HeaderPagesComponent TitlePage="Resources" Description="Manage your resources">
    <FluentButton Appearance="Appearance.Accent" OnClick="RedirectToResources">Back</FluentButton>
</HeaderPagesComponent>

<FluentDivider Style="width: 100%;height:20px;" Orientation=Orientation.Horizontal Role="DividerRole.Separator"></FluentDivider>

<FluentCard>
    <FluentStack Orientation="Orientation.Vertical" Gap="1rem">
        <FluentTextField Label="Name" @bind-Value="scope.Name" />
        <FluentTextArea Label="Description" @bind-Value="scope.Description" />
        <FluentButton Appearance="Appearance.Accent" OnClick="CreateScope">Create</FluentButton>
    </FluentStack>
</FluentCard>

@code {
    private ScopeViewModel scope = new();

    private async Task CreateScope()
    {
        CancellationTokenSource cts = new CancellationTokenSource(TimeSpan.FromMinutes(2));
        await Service.CreateScopeAsync(scope, cts.Token);
        NavigationManager.NavigateTo("/resources");
    }

    private void RedirectToResources()
    {
        NavigationManager.NavigateTo("/resources");
    }
}